# ğŸ“– å­—å¹•æå–å™¨ - å¼€å‘æ–‡æ¡£

> æœ¬æ–‡æ¡£é¢å‘å¼€å‘è€…å’Œ AI åŠ©æ‰‹ï¼Œè¯¦ç»†è¯´æ˜é¡¹ç›®æ¶æ„ã€æ ¸å¿ƒæ¨¡å—ã€æ•°æ®æµå’Œæ‰©å±•æŒ‡å—ã€‚

---

## ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
3. [æ ¸å¿ƒæ¨¡å—è¯¦è§£](#æ ¸å¿ƒæ¨¡å—è¯¦è§£)
4. [æ•°æ®æµåˆ†æ](#æ•°æ®æµåˆ†æ)
5. [API å‚è€ƒ](#api-å‚è€ƒ)
6. [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)
7. [è°ƒè¯•æŠ€å·§](#è°ƒè¯•æŠ€å·§)
8. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## é¡¹ç›®æ¦‚è¿°

### åŠŸèƒ½å®šä½

å­—å¹•æå–å™¨æ˜¯ä¸€ä¸ª Chrome æµè§ˆå™¨æ‰©å±•ï¼ˆManifest V3ï¼‰ï¼Œä¸»è¦åŠŸèƒ½ï¼š

1. **å­—å¹•æ‹¦æˆª**ï¼šé€šè¿‡ä»£ç† `fetch` å’Œ `XMLHttpRequest`ï¼Œè‡ªåŠ¨æ‹¦æˆª YouTube/Bilibili çš„å­—å¹•è¯·æ±‚
2. **å­—å¹•ä¸‹è½½**ï¼šè§£æå¤šç§å­—å¹•æ ¼å¼ï¼Œæä¾›çº¯æ–‡æœ¬ä¸‹è½½
3. **AI æ€»ç»“**ï¼šè°ƒç”¨ OpenAI å…¼å®¹ APIï¼Œå¯¹å­—å¹•å†…å®¹è¿›è¡Œæµå¼æ€»ç»“

### æŠ€æœ¯é€‰å‹

| æŠ€æœ¯ | é€‰æ‹© | ç†ç”± |
|------|------|------|
| æ‰©å±•è§„èŒƒ | Manifest V3 | Chrome æœ€æ–°è¦æ±‚ï¼Œå®‰å…¨æ€§æ›´é«˜ |
| è„šæœ¬è¯­è¨€ | åŸç”Ÿ JavaScript | æ— éœ€æ„å»ºå·¥å…·ï¼Œå¼€å‘ç®€å• |
| æ ·å¼æ–¹æ¡ˆ | åŸç”Ÿ CSS | å®Œå…¨æ§åˆ¶ï¼Œæ— ä¾èµ– |
| AI é€šä¿¡ | SSE æµå¼ | å®æ—¶è¾“å‡ºï¼Œç”¨æˆ·ä½“éªŒå¥½ |

---

## æŠ€æœ¯æ¶æ„

### æ–‡ä»¶èŒè´£çŸ©é˜µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Chrome Extension                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  manifest.json          æ‰©å±•é…ç½®ï¼Œå£°æ˜æƒé™å’Œè„šæœ¬               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ background  â”‚  â”‚   popup     â”‚  â”‚  options    â”‚              â”‚
â”‚  â”‚    .js      â”‚  â”‚ .html/.js   â”‚  â”‚ .html/.js   â”‚              â”‚
â”‚  â”‚             â”‚  â”‚   /.css     â”‚  â”‚   /.css     â”‚              â”‚
â”‚  â”‚ Service     â”‚  â”‚ å¼¹å‡ºçª—å£    â”‚  â”‚ è®¾ç½®é¡µé¢    â”‚              â”‚
â”‚  â”‚ Worker      â”‚  â”‚ ç”¨æˆ·äº¤äº’    â”‚  â”‚ é…ç½®ç®¡ç†    â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚         â”‚                â”‚                â”‚                      â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                          â”‚                                       â”‚
â”‚                   chrome.runtime API                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    Content Scripts                       â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚ content_script  â”‚â”€â”€â”€â–¶â”‚      inject.js          â”‚     â”‚    â”‚
â”‚  â”‚  â”‚     .js         â”‚    â”‚ (injected into page)    â”‚     â”‚    â”‚
â”‚  â”‚  â”‚ æ¡¥æ¥é€šä¿¡        â”‚    â”‚ æ‹¦æˆªç½‘ç»œè¯·æ±‚            â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    Shared Modules                        â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚    â”‚
â”‚  â”‚  â”‚  utils.js   â”‚         â”‚   chrome-api.js     â”‚        â”‚    â”‚
â”‚  â”‚  â”‚ å…¬å…±å‡½æ•°    â”‚         â”‚ Promise å°è£…        â”‚        â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æƒé™è¯´æ˜

```json
{
  "permissions": [
    "storage",      // æœ¬åœ°å­˜å‚¨é…ç½®å’Œå­—å¹•æ•°æ®
    "activeTab",    // è·å–å½“å‰æ ‡ç­¾é¡µä¿¡æ¯
    "scripting"     // åŠ¨æ€æ³¨å…¥è„šæœ¬
  ],
  "host_permissions": [
    "*://*.youtube.com/*",
    "*://*.bilibili.com/*",
    "*://*.hdslb.com/*"     // Bilibili CDN
  ]
}
```

---

## æ ¸å¿ƒæ¨¡å—è¯¦è§£

### 1. inject.js - ç½‘ç»œè¯·æ±‚æ‹¦æˆªå™¨

**èŒè´£**ï¼šä»£ç†æµè§ˆå™¨åŸç”Ÿçš„ `fetch` å’Œ `XMLHttpRequest`ï¼Œæ‹¦æˆªå­—å¹•è¯·æ±‚ã€‚

**å·¥ä½œåŸç†**ï¼š

```javascript
// ä»£ç† fetch
const originalFetch = window.fetch;
window.fetch = async function (...args) {
    const response = await originalFetch.apply(this, args);
    
    // æ£€æŸ¥ URL æ˜¯å¦åŒ¹é…å­—å¹•ç‰¹å¾
    if (isSubtitleUrl(args[0])) {
        const clonedResponse = response.clone();
        const data = await clonedResponse.text();
        
        // å‘é€ç»™ content script
        window.postMessage({
            type: 'SUBTITLE_CAPTURED',
            url: args[0],
            data: data
        }, '*');
    }
    
    return response;
};
```

**å­—å¹• URL ç‰¹å¾åŒ¹é…**ï¼š

| å¹³å° | URL ç‰¹å¾ |
|------|----------|
| YouTube | åŒ…å« `timedtext` æˆ– `srv3` |
| Bilibili | åŒ…å« `subtitle` ä¸”ä»¥ `.json` ç»“å°¾ |

### 2. content_script.js - æ¶ˆæ¯æ¡¥æ¥å™¨

**èŒè´£**ï¼šè¿æ¥é¡µé¢ä¸Šä¸‹æ–‡ï¼ˆinject.jsï¼‰å’Œæ‰©å±•ä¸Šä¸‹æ–‡ï¼ˆbackground.jsï¼‰ã€‚

**é€šä¿¡æµç¨‹**ï¼š

```
inject.js (é¡µé¢ä¸Šä¸‹æ–‡)
    â”‚
    â”‚ window.postMessage()
    â–¼
content_script.js (å†…å®¹è„šæœ¬ä¸Šä¸‹æ–‡)
    â”‚
    â”‚ chrome.runtime.sendMessage()
    â–¼
background.js (Service Worker ä¸Šä¸‹æ–‡)
```

### 3. background.js - åå°æœåŠ¡

**èŒè´£**ï¼š

1. ç¼“å­˜å­—å¹•æ•°æ®ï¼ˆå†…å­˜ + chrome.storageï¼‰
2. å¤„ç† AI API è¯·æ±‚ä»£ç†
3. ç®¡ç†æ‰©å±•å›¾æ ‡ Badge

**æ ¸å¿ƒåŠŸèƒ½æ¨¡å—**ï¼š

```javascript
// 1. å­—å¹•å­˜å‚¨
chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {
    if (message.type === 'subtitle-found') {
        // å­˜å‚¨åˆ°å†…å­˜ç¼“å­˜å’Œ chrome.storage
    }
});

// 2. AI è¿æ¥æµ‹è¯•
if (message.action === 'testConnection') {
    // å‘é€æµ‹è¯•è¯·æ±‚ï¼Œè¿”å›å»¶è¿Ÿå’ŒçŠ¶æ€
}

// 3. æµå¼ AI æ€»ç»“
chrome.runtime.onConnect.addListener((port) => {
    if (port.name === 'summarize-stream') {
        // å»ºç«‹ SSE æµå¼è¿æ¥
    }
});
```

### 4. popup.js - å¼¹å‡ºçª—å£é€»è¾‘

**èŒè´£**ï¼šç”¨æˆ·äº¤äº’ç•Œé¢ï¼ŒåŒ…æ‹¬å­—å¹•é€‰æ‹©ã€ä¸‹è½½å’Œ AI æ€»ç»“ã€‚

**çŠ¶æ€ç®¡ç†**ï¼š

```javascript
// å­—å¹•æ•°æ®æ¥æº
chrome.storage.local.get([`subtitles_${tabId}`], (result) => {
    const subtitles = result[key] || [];
    // æ¸²æŸ“åˆ—è¡¨...
});

// AI æµå¼è¾“å‡º
const port = chrome.runtime.connect({ name: 'summarize-stream' });
port.onMessage.addListener((msg) => {
    if (msg.type === 'chunk') {
        // è¿½åŠ å†…å®¹å¹¶æ¸²æŸ“
    }
});
```

### 5. utils.js - å…¬å…±å·¥å…·æ¨¡å—

**å¯¼å‡ºå‡½æ•°**ï¼š

| å‡½æ•° | ç”¨é€” |
|------|------|
| `markdownToHtml(md)` | å°† Markdown è½¬æ¢ä¸º HTML |
| `extractSubtitleText(data, url)` | ä»åŸå§‹å­—å¹•æ•°æ®ä¸­æå–çº¯æ–‡æœ¬ |

### 6. chrome-api.js - Chrome API Promise å°è£…

**å¯¼å‡ºå¯¹è±¡**ï¼š`ChromeAPI`

| æ–¹æ³• | åŸç”Ÿ API | è¿”å›å€¼ |
|------|----------|--------|
| `getCurrentTab()` | `chrome.tabs.query` | `Promise<Tab>` |
| `storageGet(keys)` | `chrome.storage.local.get` | `Promise<Object>` |
| `storageSet(items)` | `chrome.storage.local.set` | `Promise<void>` |
| `sendMessage(msg)` | `chrome.runtime.sendMessage` | `Promise<any>` |

---

## æ•°æ®æµåˆ†æ

### å­—å¹•æ•è·æµç¨‹

```
ç”¨æˆ·æ’­æ”¾è§†é¢‘
    â”‚
    â–¼
æµè§ˆå™¨å‘èµ·å­—å¹•è¯·æ±‚ (fetch/XHR)
    â”‚
    â–¼
inject.js æ‹¦æˆªè¯·æ±‚
    â”‚ 
    â”‚ è§£æ URLï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºå­—å¹•
    â–¼
inject.js å…‹éš†å“åº”æ•°æ®
    â”‚
    â”‚ window.postMessage
    â–¼
content_script.js æ¥æ”¶æ¶ˆæ¯
    â”‚
    â”‚ chrome.runtime.sendMessage
    â–¼
background.js å­˜å‚¨æ•°æ®
    â”‚
    â”‚ æ›´æ–° Badge æ•°å­—
    â–¼
ç”¨æˆ·ç‚¹å‡»æ‰©å±•å›¾æ ‡
    â”‚
    â–¼
popup.js ä» storage è¯»å–å­—å¹•åˆ—è¡¨
    â”‚
    â–¼
æ¸²æŸ“å­—å¹•é€‰æ‹©å™¨
```

### AI æ€»ç»“æµç¨‹

```
ç”¨æˆ·ç‚¹å‡»"æ€»ç»“"æŒ‰é’®
    â”‚
    â–¼
popup.js è·å–é€‰ä¸­å­—å¹•å†…å®¹
    â”‚
    â”‚ ä½¿ç”¨ extractSubtitleText() è§£æ
    â–¼
popup.js å»ºç«‹é•¿è¿æ¥
    â”‚
    â”‚ chrome.runtime.connect('summarize-stream')
    â–¼
å‘é€å¼€å§‹æ¶ˆæ¯ { action: 'start', subtitle, config }
    â”‚
    â–¼
background.js æ„é€  API è¯·æ±‚
    â”‚
    â”‚ ä» storage è¯»å– API é…ç½®
    â–¼
å‘èµ· fetch è¯·æ±‚ (stream: true)
    â”‚
    â–¼
å¾ªç¯è¯»å– SSE æ•°æ®å—
    â”‚
    â”‚ è§£æ JSONï¼Œæå– delta.content
    â–¼
é€šè¿‡ port.postMessage å‘é€ chunk
    â”‚
    â–¼
popup.js æ¥æ”¶ chunk
    â”‚
    â”‚ è¿½åŠ åˆ° streamedContent
    â”‚ ä½¿ç”¨ markdownToHtml() æ¸²æŸ“
    â–¼
æ˜¾ç¤ºåœ¨ç•Œé¢ä¸Š
```

---

## API å‚è€ƒ

### æ¶ˆæ¯ç±»å‹

#### å­—å¹•æ•è·æ¶ˆæ¯

```typescript
interface SubtitleFoundMessage {
    type: 'subtitle-found';
    data: {
        url: string;      // å­—å¹• URL
        lang: string;     // è¯­è¨€æ ‡è¯†
        data: string;     // åŸå§‹å­—å¹•å†…å®¹
    };
}
```

#### AI è¿æ¥æµ‹è¯•æ¶ˆæ¯

```typescript
// è¯·æ±‚
interface TestConnectionMessage {
    action: 'testConnection';
    config: {
        url: string;
        key: string;
        model: string;
    };
}

// å“åº”
interface TestConnectionResponse {
    success: boolean;
    status: number;
    latency: number;           // æ¯«ç§’
    aiConnectionContent: string;  // AI è¿”å›å†…å®¹
    data: string;              // åŸå§‹å“åº”
}
```

#### AI æ€»ç»“æµå¼æ¶ˆæ¯

```typescript
// å¼€å§‹æ¶ˆæ¯
interface SummarizeStartMessage {
    action: 'start';
    subtitle: string;
    lang: string;
    title: string;
    config: ProviderConfig;
}

// æµå¼å“åº”
type StreamMessage = 
    | { type: 'chunk'; content: string }
    | { type: 'done' }
    | { type: 'error'; error: string };
```

### å­˜å‚¨ç»“æ„

```typescript
// chrome.storage.local

// å­—å¹•ç¼“å­˜ (æŒ‰æ ‡ç­¾é¡µ)
interface SubtitleCache {
    [`subtitles_${tabId}`]: Subtitle[];
}

interface Subtitle {
    url: string;
    lang: string;
    data: string;
}

// AI é…ç½®
interface AIConfig {
    providers: Provider[];
    activeProviderId: string;
}

interface Provider {
    id: string;
    name: string;
    url: string;
    key: string;
    model: string;
    systemPrompt?: string;
    prompt?: string;
    maxTokens?: number;
    temperature?: number;
}
```

---

## å¼€å‘æŒ‡å—

### ç¯å¢ƒå‡†å¤‡

1. Chrome æµè§ˆå™¨ï¼ˆæ¨èæœ€æ–°ç‰ˆï¼‰
2. ä»£ç ç¼–è¾‘å™¨ï¼ˆæ¨è VS Codeï¼‰
3. æ— éœ€ Node.js æˆ–æ„å»ºå·¥å…·

### æœ¬åœ°å¼€å‘æµç¨‹

1. ä¿®æ”¹ä»£ç åï¼Œè¿›å…¥ `chrome://extensions`
2. ç‚¹å‡»æ‰©å±•çš„ **åˆ·æ–°** æŒ‰é’®
3. å¦‚æœä¿®æ”¹äº† `content_script.js` æˆ– `inject.js`ï¼Œéœ€è¦åˆ·æ–°ç›®æ ‡é¡µé¢
4. å¦‚æœä¿®æ”¹äº† `popup.js`ï¼Œé‡æ–°æ‰“å¼€å¼¹çª—å³å¯

### æ·»åŠ æ–°å­—å¹•å¹³å°æ”¯æŒ

1. **ä¿®æ”¹ inject.js**ï¼š

   ```javascript
   function isSubtitleUrl(url) {
       // æ·»åŠ æ–°å¹³å°çš„ URL ç‰¹å¾
       if (url.includes('newplatform.com') && url.includes('subtitle')) {
           return true;
       }
       // ...
   }
   ```

2. **ä¿®æ”¹ utils.js**ï¼ˆå¦‚æœ‰å¿…è¦ï¼‰ï¼š

   ```javascript
   function extractSubtitleText(data, url) {
       // æ·»åŠ æ–°å¹³å°çš„è§£æé€»è¾‘
       if (url.includes('newplatform.com')) {
           // è§£æé€»è¾‘...
       }
   }
   ```

3. **æ›´æ–° manifest.json**ï¼š

   ```json
   "host_permissions": [
       "*://*.newplatform.com/*"
   ]
   ```

### æ·»åŠ æ–° AI åŠŸèƒ½

1. **ä¿®æ”¹ background.js**ï¼šæ·»åŠ æ–°çš„æ¶ˆæ¯å¤„ç†åˆ†æ”¯
2. **ä¿®æ”¹ popup.js**ï¼šæ·»åŠ  UI äº¤äº’é€»è¾‘
3. **ä¿®æ”¹ options.js**ï¼šæ·»åŠ é…ç½®é¡¹ï¼ˆå¦‚éœ€è¦ï¼‰

---

## è°ƒè¯•æŠ€å·§

### æŸ¥çœ‹åå°æ—¥å¿—

1. è¿›å…¥ `chrome://extensions`
2. æ‰¾åˆ°æœ¬æ‰©å±•
3. ç‚¹å‡» **Service Worker** é“¾æ¥
4. åœ¨ DevTools Console ä¸­æŸ¥çœ‹æ—¥å¿—

### æŸ¥çœ‹å†…å®¹è„šæœ¬æ—¥å¿—

1. æ‰“å¼€ç›®æ ‡ç½‘é¡µï¼ˆYouTube/Bilibiliï¼‰
2. æŒ‰ F12 æ‰“å¼€ DevTools
3. åœ¨ Console ä¸­æŸ¥çœ‹ `[Content]` æˆ– `[Inject]` å‰ç¼€çš„æ—¥å¿—

### æŸ¥çœ‹å¼¹çª—æ—¥å¿—

1. å³é”®ç‚¹å‡»æ‰©å±•å›¾æ ‡
2. é€‰æ‹©"æ£€æŸ¥å¼¹å‡ºå†…å®¹"
3. åœ¨ DevTools Console ä¸­æŸ¥çœ‹æ—¥å¿—

### è°ƒè¯•å­˜å‚¨æ•°æ®

```javascript
// åœ¨æ‰©å±•çš„ä»»æ„ DevTools Console ä¸­æ‰§è¡Œ
chrome.storage.local.get(null, console.log);
```

---

## å¸¸è§é—®é¢˜

### Q: å­—å¹•æ£€æµ‹ä¸åˆ°ï¼Ÿ

1. ç¡®ä¿è§†é¢‘å·²å¼€å¯å­—å¹•
2. å°è¯•åˆ‡æ¢å­—å¹•è¯­è¨€
3. åˆ·æ–°é¡µé¢åé‡æ–°æ’­æ”¾
4. æ£€æŸ¥ inject.js çš„ URL åŒ¹é…è§„åˆ™

### Q: AI æ€»ç»“å¤±è´¥ï¼Ÿ

1. æ£€æŸ¥ API é…ç½®æ˜¯å¦æ­£ç¡®
2. ä½¿ç”¨"è¿æ¥æµ‹è¯•"éªŒè¯
3. æŸ¥çœ‹ background.js çš„ Service Worker æ—¥å¿—
4. ç¡®è®¤ API Key ä½™é¢å……è¶³

### Q: ä¿®æ”¹ä»£ç åä¸ç”Ÿæ•ˆï¼Ÿ

1. åˆ·æ–°æ‰©å±•ï¼ˆ`chrome://extensions` â†’ åˆ·æ–°æŒ‰é’®ï¼‰
2. å¦‚æœæ˜¯å†…å®¹è„šæœ¬ï¼Œåˆ·æ–°ç›®æ ‡ç½‘é¡µ
3. å¦‚æœæ˜¯å¼¹çª—ä»£ç ï¼Œå…³é—­åé‡æ–°æ‰“å¼€å¼¹çª—

---

## è´¡çŒ®è€…

- æ„Ÿè°¢æ‰€æœ‰ä¸ºæœ¬é¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…ï¼

---

*æœ€åæ›´æ–°ï¼š2026-02-05*
